/**!
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 * @private
 */

import {AuthInterceptor} from '@ciscospark/spark-core';

/**
 * @class
 * @extends AuthInterceptor
 * @private
 */
export default class CiscoSparkAuthInterceptor extends AuthInterceptor {
  constructor(spark) {
    super(spark);
  }

  static create() {
    return new CiscoSparkAuthInterceptor(this);
  }

  requiresCredentials(options) {
    if (options.uri.includes(this.spark.config.hydraServiceUrl)) {
      return true;
    }

    return false;
  }

  requiresClientCredentials() {
    return false;
  }

  shouldAttemptReauth(reason, options) {
    if (options && options.shouldRefreshAccessToken === false) {
      return false;
    }

    if (reason.statusCode === 401) {
      return true;
    }

    return false;
  }
}
