/**!
 *
 * Copyright (c) 2015 Cisco Systems, Inc. See LICENSE file.
 */

import {Interceptor} from '@ciscospark/http-core';

export default class RequestTimingInterceptor extends Interceptor {
  static create(options) {
    return new RequestTimingInterceptor(options);
  }

  onRequest(options) {
    options.$timings = options.$timings || {};
    options.$timings.requestStart = Date.now();
    return options;
  }

  onRequestError(options) {
    options.$timings.requestEnd = options.$timings.requestFail = Date.now();
    return Promise.reject(options);
  }

  onResponse(options, response) {
    options.$timings.requestEnd = Date.now();
    return Promise.resolve(response);
  }

  onResponseError(options, response) {
    options.$timings.requestEnd = options.$timings.requestFail = Date.now();
    return Promise.reject(response);
  }
}
